{% extends 'base.html' %}
{% block title %}Manage API Key - {{ college.name }}{% endblock %}

{% block content %}
<div class="row justify-content-center mt-5">
    <div class="col-md-6">
        <div class="card shadow-sm">
            <div class="card-header bg-primary text-white">
                <h4 class="mb-0">Manage API Key for {{ college.name }}</h4>
            </div>
            <div class="card-body">

                {% if current_key %}
                <p>
                    <strong>Current API Key:</strong>
                    <input type="text" class="form-control mb-2" value="{{ current_key }}" id="apiKeyField" readonly>
                </p>
                {% else %}
                <p class="text-warning">No API key generated yet.</p>
                {% endif %}

                {% if new_key %}
                <p class="mt-3">
                    <strong>Newly Generated API Key:</strong>
                    <input type="text" class="form-control" value="{{ new_key }}" id="newApiKeyField" readonly>
                </p>
                {% endif %}

                <form method="post" class="d-inline">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-success">Generate / Regenerate API Key</button>
                </form>

                {% if new_key %}
                <button class="btn btn-secondary ms-2" onclick="copyApiKey('newApiKeyField')">Copy New Key</button>
                {% endif %}

            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
function copyApiKey(fieldId) {
    const input = document.getElementById(fieldId);
    if (input) {
        input.select();
        input.setSelectionRange(0, 99999);
        document.execCommand("copy");
        alert("API Key copied to clipboard!");
    }
}
</script>
{% endblock %}
